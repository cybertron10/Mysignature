# info to search signature
id: Host-Header_injection
type: fuzz
info:
  name: Host Header Injection
  risk: Medium

# jaeles scan -p 'dest=xx.burpcollaborator.net' ...
params:
  - dest: '{{.oob}}'

variables:
  - head: |
      Host

payloads:
  - "{{.dest}}"

requests:
  - method: GET
  - generators:
      - Header("{{.payload}}", "{{.head}}")
    detections:
      - >-
        RegexSearch("resHeaders", "(?m)^(L|l)ocation: ((http|https)://)?{{.dest}}")
      - >-
        RegexSearch("Resbody", "(?m)<html><body>[a-z0-9]+</body>")
